[Unit]
Description=Tomcat servlet container
After=network.target

[Service]
Restart=on-failure
Environment=TOMCAT_JAVA_HOME={{ ansible_local.java.general.java_home }}
Environment=CATALINA_HOME={{ tomcat_env_catalina_home }}
Environment=CATALINA_BASE={{ tomcat_env_catalina_base }}
Environment=CATALINA_OPTS="{{ tomcat_env_catalina_opts|default('') }}"
{% if tomcat_service_umask is defined %}
UMask={{ tomcat_service_umask }}
{% endif %}

ExecStart={{ ansible_local.java.general.java_home }}/bin/java \
  -Djava.util.logging.config.file={{ tomcat_env_catalina_base }}/conf/logging.properties \
  -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager \
  -Djava.endorsed.dirs={{ tomcat_env_catalina_home }}/endorsed \
  -Dcatalina.home={{ tomcat_env_catalina_home }} \
  -Dcatalina.base={{ tomcat_env_catalina_base }} \
  -Djava.io.tmpdir={{ tomcat_env_catalina_base }}/temp \
  -classpath "{{ tomcat_env_catalina_home }}/bin/bootstrap.jar:{{ tomcat_env_catalina_home }}/bin/tomcat-juli.jar" \
  org.apache.catalina.startup.Bootstrap start

ExecStop={{ ansible_local.java.general.java_home }}/bin/java \
  -Djava.util.logging.config.file={{ tomcat_env_catalina_base }}/conf/logging.properties \
  -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager \
  -Djava.endorsed.dirs={{ tomcat_env_catalina_home }}/endorsed \
  -Dcatalina.home={{ tomcat_env_catalina_home }} \
  -Dcatalina.base={{ tomcat_env_catalina_base }} \
  -Djava.io.tmpdir={{ tomcat_env_catalina_base }}/temp \
  -classpath "{{ tomcat_env_catalina_home }}/bin/bootstrap.jar:{{ tomcat_env_catalina_home }}/bin/tomcat-juli.jar" \
  org.apache.catalina.startup.Bootstrap stop


[Install]
WantedBy=multi-user.target
